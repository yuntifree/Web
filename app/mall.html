<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <meta charset="utf-8">
  <title>东莞无限</title>
  <link rel="stylesheet" type="text/css" href="css/reset.css">
  <style type="text/css">
  html,body {
    width: 100%;
    height: auto;
    min-height: 100%;
    background-color: #f0f0f0;
  }
  .section {
    width: 100%;
    height: auto;
    position: relative;
  }
  .sec-bg {
    width: 100%;
    height: auto;
    display: block;
  }
  .sec-info {
    width: 100%;
    height: auto;
    position: absolute;
    top: 0;
    left: 0;
  }
  .sec-info-tit {
    font-size: 0.36rem;
    font-weight: 500;
    color: #fff;
  }
  .sec-info-integral {
    width: 36%;
    height: auto;
    margin: 0 auto;
    position: relative;
  }
  .sec-info-integral img {
    display: block;
    width: 100%;
    height: auto;
  }
  .integral {
    display: block;
    width: 88%;
    height: auto;
    font-size: 0.64rem;
    font-weight: 500;
    text-align: center;
    text-shadow: 0 4px 8px #cda40f;
    position: absolute;
    top: 50%;
    left: 0;
    transform: translateY(-50%);
    -webkit-transform: translateY(-50%);
    color: #fff;
  }
  .integral-btn {
    display: block;
    width: 120%;
    height: 0.92rem;
    margin: 0 auto;
    line-height: 0.92rem;
    border-radius: 0.44rem;
    background-color: #ffffff;
    box-shadow: 0 0.04rem 0.2rem 0 #68a2e0;
    font-size: 0.36rem;
    font-weight: 500;
    color: #5aa1fb;
    position: relative;
    left: -10%;
    bottom: 0.24rem;
  }
  .link-rule {
    display: block;
    width: 1.14rem;
    height: auto;
    padding: 0.14rem 0;
    font-size: 0.28rem;
    border-bottom: 0.02rem solid #fff;
    margin: 0 auto;
  }
  .voucher {
    width: 100%;
    height: auto;
  }
  .voucher li {
    width: 96%;
    height: auto;
    margin: 0 auto;
    margin-top: 0.4rem;
    position: relative;
  }
  .vocher-img {
    display: block;
    width: 100%;
    height: auto;
  }
  .vocher-notuse,
  .vocher-canuse {
    width: 1.4rem;
    height: 1.2rem;
    position: absolute;
    top: 50%;
    right: 8%;
    transform: translateY(-50%);
    -webkit-transform: translateY(-50%);
  }
  .vocher-canuse  {
    height: auto;
  }
  .vocher-btn {
    display: block;
    width: 1.4rem;
    height: 0.6rem;
    border-radius: 0.16rem;
    border: solid 0.02rem #4a90e2;
    font-size: 0.36rem;
    color: #4a90e2;
  }
  .vocher-integral {
    font-size: 0.28rem;
    color: #4a90e2;
    margin-top: 0.12rem;
  }
  .vocher-used {
    display: none;
    width: 26%;
    height: auto;
    position: absolute;
    bottom: 0;
    right: 0.66rem;
  }
  .vocher-used img {
    width: 100%;
    height: auto;
    display: block;
  }
  .col96 {
    color: #969696;
  }
  </style>
</head>
<body>
  <script type="text/html" id="tplInfo">
    <div class="section">
      <img class="sec-bg" src="http://img.yunxingzh.com/786ac6e5-bb38-400f-853e-b05e7e7c7d40.png">
      <div class="sec-info">
        <h2 class="g-tac sec-info-tit">我的积分</h2>
        <div class="sec-info-integral">
          <img  src="http://img.yunxingzh.com/afe6dc81-178f-48fc-87e3-7a3f3aef4948.png">
          <span class="integral g-tac">{{score}}</span>
          <button class="{{sign ? 'signintegral-btn' : 'signintegral-btn col96'}}">{{sign ? '今天已领取' : '每天签到领积分'}}</button>
        </div>
        <a href="javascript:;" class="link-rule">活动规则</a>
      </div>
    </div>
    <ul class="voucher">
      {{if items && items.length>0}}
        {{each items item idx}}
          <li>
            <img class="vocher-img" src="{{item.url}}">
            {{if item.status==0}}
            <div class="vocher-notuse">
              <button class="vocher-btn">兑换</button>
              <p class="vocher-integral g-tac">300积分</p>
            </div>
            {{else if item.status==1}}
            <div class="vocher-canuse">
              <button class="vocher-btn">去使用</button>
            </div>
            {{else if item.status==2}}
            <div class="vocher-used">
              <img src="http://img.yunxingzh.com/ceb8007d-d1d3-49de-ba9b-5e4c279035b3.png">
            </div>
            {{/if}}
          </li>
        {{/each}}
      {{/if}}
    </ul>
  </script>
  <script type="text/javascript" src="js/zepto.min.js"></script>
  <script type="text/javascript" src="js/cgi.js"></script>
  <script type="text/javascript">
    font(true);
    function font(bFont) {
      if (document && window) {
        // init font
        if (bFont) {
          var docEl = document.documentElement;
          var isIOS = navigator.userAgent.match(/iphone|ipod|ipad/gi);
          var dpr = isIOS ? Math.min(window.devicePixelRatio, 3) : 1;
          dpr = window.top === window.self ? dpr : 1; //被iframe引用时，禁止缩放
          var scale = 1 / dpr;
          var resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize';

          $(docEl).data('dpr', dpr);
          var recalc = function() {
            var width = docEl.clientWidth;
            if (width / dpr > 640) {
              width = 640 * dpr;
            }
            docEl.style.fontSize = 100 * (width / 750) + 'px';
          };
          recalc();
          if (!document.addEventListener) return;
          window.addEventListener(resizeEvt, recalc, false);
        }
      }
    }
    var uid = CGI.query().uid;
    var token = CGI.query.token;
    var param = {
      uid : ~~uid,
      token: token
    }
    CGI.post('get_user_score', param, function(resp) {
      if (resp.errno == 0) {
        var data = resp.data;
        $('body').append(template('tplInfo'), data);
        //console.log(resp.data);
      } else {
        console.log(resp.desc);
      }
    })
  </script>
</body>

</html>
